<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.66">
 <TITLE>Commodore 64 specific information for cc65: Linker configurations</TITLE>
 <LINK HREF="c64-5.html" REL=next>
 <LINK HREF="c64-3.html" REL=previous>
 <LINK HREF="c64.html#toc4" REL=contents>
</HEAD>
<BODY>
<A HREF="c64-5.html">Next</A>
<A HREF="c64-3.html">Previous</A>
<A HREF="c64.html#toc4">Contents</A>
<HR>
<H2><A NAME="s4">4.</A> <A HREF="c64.html#toc4">Linker configurations</A></H2>


<P>The ld65 linker comes with a builtin config file for the Commodore&nbsp;64,
which is used via <CODE>-t c64</CODE> (and displayed via <CODE>--dump-config c64</CODE>). The
c64 package comes with additional secondary linker config files, which are
used via <CODE>-C &lt;configfile&gt;</CODE>.</P>


<H2><A NAME="ss4.1">4.1</A> <A HREF="c64.html#toc4.1">builtin config file</A>
</H2>


<P>The builtin configuration is tailored to C programs. It supplies the load
address and a small BASIC stub that starts the compiled program using a SYS
command.</P>


<H2><A NAME="ss4.2">4.2</A> <A HREF="c64.html#toc4.2"><CODE>c64-asm.cfg</CODE></A>
</H2>


<P>This configuration is made for assembler programmers who don't need a special
setup. The default start address is $801. It can be changed with the
linker command line option <CODE>--start-addr</CODE>. All standard segments with the
exception of <CODE>zeropage</CODE> are written to the output file and a two byte load
address is prepended.</P>
<P>To use this config file, assemble with <CODE>-t c64</CODE> and link with <CODE>-C
c64-asm.cfg</CODE>. The former will make sure that correct character translation is
in effect, while the latter supplies the actual config. When using <CODE>cl65</CODE>,
use both command line options.</P>
<P>Sample command line for <CODE>cl65</CODE>:</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
cl65 -o file.prg -t c64 -C c64-asm.cfg source.s
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>To generate code that loads to $C000:</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
cl65 -o file.prg --start-addr $C000 -t c64 -C c64-asm.cfg source.s
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>It is also possible to add a small BASIC header to the program, that uses SYS
to jump to the program entry point (which is the start of the code segment).
The advantage is that the program can be started using RUN.</P>
<P>To generate a program with a BASIC SYS header, use</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
cl65 -o file.prg -u __EXEHDR__ -t c64 -C c64-asm.cfg source.s
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Please note that in this case a changed start address doesn't make sense,
since the program must be loaded to the BASIC start address.</P>


<HR>
<A HREF="c64-5.html">Next</A>
<A HREF="c64-3.html">Previous</A>
<A HREF="c64.html#toc4">Contents</A>
</BODY>
</HTML>
